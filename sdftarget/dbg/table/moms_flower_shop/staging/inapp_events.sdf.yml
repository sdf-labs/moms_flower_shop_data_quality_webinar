table:
  name: MOMS_FLOWER_SHOP.STAGING.INAPP_EVENTS
  dialect: snowflake
  casing-policy: preserve
  materialization: view
  purpose: model
  dependencies:
  - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS
  depended-on-by:
  - MOMS_FLOWER_SHOP.ANALYTICS.AGG_MARKETING_CAMPAIGNS
  - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS
  - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS_V2
  columns:
  - name: EVENT_ID
    description: A unique identifier of an in-app event within mom's flower shop's mobile app
    datatype: decimal(38, 0)
    classifiers:
    - EVENT.inapp
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.EVENT_ID
    forward-lineage:
      copy:
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS.EVENT_ID
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS_V2.EVENT_ID
      modify:
      - MOMS_FLOWER_SHOP.ANALYTICS.AGG_MARKETING_CAMPAIGNS.EVENT_COUNT
  - name: CUSTOMER_ID
    description: The identifier of the customer that performed the event
    datatype: decimal(38, 0)
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.CUSTOMER_ID
    forward-lineage:
      copy:
      - MOMS_FLOWER_SHOP.ANALYTICS.AGG_MARKETING_CAMPAIGNS.CUSTOMER_ID
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS.CUSTOMER_ID
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS_V2.CUSTOMER_ID
  - name: EVENT_TIME
    description: The unixtime in which the event occurred
    datatype: decimal(38, 0)
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.EVENT_TIME
    forward-lineage:
      copy:
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS.INSTALL_TIME
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS_V2.INSTALL_TIME
  - name: EVENT_NAME
    description: The name of the in-app events. Supported events - install, add_to_cart, go_to_checkout, place_order
    datatype: varchar
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.EVENT_NAME
  - name: EVENT_VALUE
    description: |
      Any numeric value associated with the event.  For example, upon placing an order, the event value would be the total order amount in USD.
    datatype: double
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.EVENT_VALUE
  - name: ADDITIONAL_DETAILS
    description: |
      A JSON containing additional details about the order.  For exmaple, upon placing an order, the additional details will contain a delivery ID and other order information.
    datatype: varchar
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.ADDITIONAL_DETAILS
  - name: PLATFORM
    description: iOS or Android
    datatype: varchar
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.PLATFORM
    forward-lineage:
      copy:
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS.PLATFORM
      - MOMS_FLOWER_SHOP.STAGING.APP_INSTALLS_V2.PLATFORM
  - name: CAMPAIGN_ID
    description: The identifier of a marketing campaign that is associated with the install of mom's flower shop mobile app.
    datatype: varchar
    lineage:
      copy:
      - MOMS_FLOWER_SHOP.RAW.RAW_INAPP_EVENTS.CAMPAIGN_ID
  tests:
  - expect: unique_columns(["event_id"])
    severity: error
  source-locations:
  - path: metadata/staging/inapp_events.sdf.yml
  - path: models/staging/inapp_events.sql
